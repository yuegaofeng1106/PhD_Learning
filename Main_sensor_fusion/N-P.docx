
基于N-P准则的多传感器信息融合

姓名：岳高峰，学号：4121357003，班级：B2174
（西安交通大学电信学部网络空间安全学院  西安  710049  643375731@qq.com）
摘	要：基于N-P准则的多传感器信息融合。通过对检测统计量 和阈值即似然比 等参数做一系列假设并设计判别规则。其次通过调整虚警概率设定、信号幅值、量测序列长度、量测噪声水平等参数，分析观察概率特性（ROC）曲线的变化。通过ROC曲线我们可以比较不同传感器的检测性能，可以从图中看出采用多传感器融合的检测性能明显优于单传感器。
关键词：N-P法则；多传感器融合；序贯判决；似然比检验

 
1 实验内容
	考虑 个局部传感器在奈曼-皮尔逊(Neyman-Pearson，N-P)引理框架下的基于独立同分布（i.i.d）量测序列的信号检测判决与融合问题。 表示检测信号目标不存在， 表示有未知检测信号存在，每个传感器的量测模型如下：
     （1）
这里， 代表任意时刻传感器 的观测值， ， 为零均值且给定方差的高斯白噪声（WGN），信号幅值 。基于下面两个假设：（1）假定传感器之间服从i.i.d；（2）假定传感器数据采集具有同步性;(3) 假定传感器先验概率或代价系数已知。
基于N-P准则我们需要对检测统计量 和阈值即似然比 等参数做一系列假设并设计判别规则。其次通过调整虚警概率设定、信号幅值、量测序列长度、量测噪声水平等参数，分析观察概率特性（ROC）曲线的变化。
2 实验原理
	对于模型的建立，我们做一些基础假设。假设 个局部传感器的高斯噪声集合为 ，设高斯噪声下 传感器的虚警概率 满足下式：
 （1）
这里 。 个传感器在虚假概率下的数据矩阵 。设第 个传感器 次观察的矢量集合为：
 （2）
对于 个传感器则有：
   （3）
因此我们得到包含高斯分布的实验量测矩阵 。为了方便叙述和分析，我们引入检测概率 、虚警概率 ：
      （4）
      （5）
对于漏探概率 、漏警概率 ，则满足下面条件：
        （6）
一个合理的判决准则应该是限制某类错误概率在可容许值，而使另一类错误概率最小。
    （7）
整体的优化目标是：
 （8）
上式中 为似然比。在信息融合问题中我们可以将 的量测划归到 ，如此便得到满足优化的阈值 。当公式成立时我们判定为 。
鉴于多传感器的序列判决融合是个复杂的问题，我们可以将其划分为三个部分。首先是单传感器的二元判决；其次是单传感器的序贯判决；最后则是多传感器的序贯判决。
2.1单传感器的二元判决。
根据最大后验概率准则（MAP），我们选择最大可能发生的假设（原假设 ，备择假设 ），其基本观察概率特性为：
   （8）
 （9）

构造基本似然比检验和判决规则：
 （10）
2.2单传感器的序贯判决
基于少量观测数据，通常不能满足虚警概率足够小或检测概率足够大，需要持续获得更多测量，就形成了序贯判决问题。解决这个问题我们引入N-P规则：在满足虚警率上限的条件下，最大化检测概率的判决规则为：
        （11）
    (11)
设进行M次观测，原假设和备择假设如下：
        （12）
给定 两个指标和门限值 和 。
     （13）     （14） 
我们统计了每个传感器的 个量测值中的判决 的概率值。
2.3多传感器的判决融合
对于 个传感器局部序贯判决结果进行联合， 个二元判决的 种可能融合规则。设 是传感器融合中心的判决函数， 。 由判决结果为1的局部判决所组成的集合。 表示 的元素个数。 ：由判决结果为0的局部判决构成的集合。由于局部检测结果是二元的，则对于N各传感器则有 种情况，这就意外着可以得到 个比值 ：
  （18）
 （19）
 （20）
对公式15两边取对数并化简得到
 （21）
由于检测统计量 是服从均值为0，方差 的高斯分布，经过标准化后得到另外的计算方法。
       （22）
上式中Q为互补累计分布函数，是单调递减函数，存在逆函数，从而门限值为；
       （23）
因为 为常数，故可以统计 去计算 。
定义： ， 
     （16）
     （17）
设进行N个传感器，原假设和备择假设如下：
        （12）
    （13）
其中： ，当等于虚警概率上限时可以求得 。参考序贯判决公式（13-14）上面式子：
     （14）
同理由于 ，此时可以取等号。传感局部判决联合似然比的条件概率：
 （15）
将 所有结果按大小排列，记为 ，并求得 和 ，求得
   （24）
 ，根据排出的顺序，求满足公式的 值，最后得到的介于两个门限值之间的值为所求。
  （25）
由对应的门限值 ，可求得一定虚警概率下的最大的检测概率，即为大于所有 的概率和。
    （26）
3 仿真实验设计
	现将实验仿真参数设置展示如下：传感器数目 ；传感器量测噪声方差： ；单个传感器量测序列长度 =10。实验所用计算机搭载
第11代因特尔CPU：Intel(R) Core(TM) i5-11400F @ 2.60GHz；机带RAM：16.0GB；操作系统为Windows 10专业版；编程语言为Python（版本3.9.7）。程序平均运行时间：4.5秒。
4 实验结果与分析
这里我们绘制每个传感器的ROC曲线，以及采用前3个传感器融合和6个传感器融合的ROC曲线。
第一组实验我们分析不加序贯判决的N-P准则下的多传感器融合，我们进行参数实验分析，主要是方便多传感器信息融合时我们能够合理地设置实验参数。当我们将随机试验次数epoch设置为1000、3000、5000、7000。我们可以得到ROC曲线如下图1。我们发现在5000左右效果有明显的变化，曲线变得更光滑了，这其实是比较好的一种结果。
    
图1 epoch变化下的ROC曲线
Fig.1 ROC curve varied by epoch

我们再变化传感器数量 ，观察结果，验证传感器数量对结果的影响。当传感器较少时，虚警概率很小，检测概率很可能不如单传感器的效果，所有多传感器融合是有必要的。我们先通过ROC曲线我们可以比较不同传感器的检测性能，可以从图中看出采用多传感器融合的检测性能明显优于单传感器
    
图2  变化下的ROC曲线
Fig.2 ROC curve varied by  

当给定 时我们还要观察给定的虚警概率 的变化值，分别取0.01，0.05，0.1，0.2。结果如下：
    
图3  变化下的ROC曲线
Fig.3 ROC curve varied by  
第二组实验我们分析加序贯判决的N-P准则下的多传感器融合，我们进行参数实验分析，当我们将随机试验次数epoch设置为3000、7000。我们可以得到ROC曲线如下图1。
  
图4 epoch变化下的ROC曲线
Fig.4 ROC curve varied by epoch

当我们将随机试验次数epoch设置为10，100，7000、10000，M设置为10，20，30。我们可以得到ROC曲线如下图1，可以看出这种情况存在一定的分界点，所以需要我们寻找虚假概率和检测概率的一个合理点。
      
 
图5 epoch和M变化下的ROC曲线
Fig.1 ROC curve varied by epoch & M

5 代码说明
	本文设计了一个主程序：main_sensor_fusion，和一个函数程序：cal_fuse。主程序里面包含主干部分和绘图部分，函数程序包含数据生成函数gen，检测概率计算函数cal，非0逻辑矩阵函数No_zero_value，单传感器判决函数fus_seq，多传感融合函数fusion。
 

